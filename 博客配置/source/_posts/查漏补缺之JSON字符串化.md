---
title: 查漏补缺之JSON字符串化
date: 2018-3-9 22:40
tags: js
---

# 查漏补缺之JSON字符串化

## JSON的转化

通常,我们将一个JSON转换为字符串的时候,会用到 JSON.stringify的方法;

对于大多数值来说,用 JSON.stringify和toString()并没有什么差别;

所有安全的值都可以被这个方法转化为字符串(安全得值是指JSON值能够呈现为有效的JSON各式的值)

不安全得值大概包括:undefined,function,symbol,包含循环引用;都无法通过这个函数处理;

当要对这些值进行处理的时候,就可以在对象中定义名为toJSON()的方法来返回一个安全的JSON值;

_toJSON能够'返回一个能够被字符串化的安全的JSON值'_
<!--more-->

**也就是说会使用JSON.stringify的时候,如果JSON离包含有一个叫做toJSON的方法,则会先执行这个方法,根据方法里所指定的规制,讲不安全的值转换为安全的值,再进行stringify转化**

## JSON.stringify的几个参数

我们一般使用JSON.stringify会使用他的第一个参数,但是他还有一些参数很实用;

JSON.stringify(json,replacer,space)

### 可选参数replacer

_他可以是一个数组或者函数_
用来制定对象序列化过程中哪些属性应该被处理,哪些应该被排除;和toJSON很像;

**当replacer是一个数组的时候:**

那么他必须是一个字符串数组,其中包含序列化要处理的对象的属性名称,除了数组里的属性名称,其他属性在转化的时候都将被忽略;

**当replacer时一个函数的时候:**

他会对对象本身调用一次,然后对对象中的每个属性各调用一次,每次传递两个参数,键和值.如要要忽略某个参数就返回undefined,否者返回制定的值;

**第一次调用因为是对对象调用,所以第一次调用的键值会是undefined**
**字符串化是递归的,他会循环对象中的每一项**
**如果需要处理的对象中有数组,使用函数调用时,键值是他在数组中的位置**

### 可选参数space

用来指定输出的缩进格式.
space是正数时是指定每一级缩进的字符数,他也可以是字符串;